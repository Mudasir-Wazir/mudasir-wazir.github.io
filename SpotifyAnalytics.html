<!DOCTYPE html>
<html style="font-size: 14px;" lang="en"><head>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta charset="utf-8">
    <meta name="keywords" content="">
    <meta name="description" content="">
    <title>SpotifyAnalytics</title>
    <link rel="stylesheet" href="nicepage.css" media="screen">
<link rel="stylesheet" href="SpotifyAnalytics.css" media="screen">
    <script class="u-script" type="text/javascript" src="jquery.js" defer=""></script>
    <script class="u-script" type="text/javascript" src="nicepage.js" defer=""></script>
    <meta name="generator" content="Nicepage 7.7.3, nicepage.com">
    <link rel="icon" href="images/favicon.png">
    
    
    
    
    
    
    
    
    
    
    
    <link id="u-theme-google-font" rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:100,100i,300,300i,400,400i,500,500i,700,700i,900,900i|Open+Sans:300,300i,400,400i,500,500i,600,600i,700,700i,800,800i">
    <script type="application/ld+json">{
		"@context": "http://schema.org",
		"@type": "Organization",
		"name": "Site1",
		"logo": "images/mwleete.png",
		"sameAs": [
				"https://www.linkedin.com/in/mudasir-wazir/",
				"https://github.com/Mudasir-Wazir",
				"mailto:maddewazir10@gmail.com"
		]
}</script>
    <meta name="theme-color" content="#478ac9">
    <meta property="og:title" content="SpotifyAnalytics">
    <meta property="og:description" content="">
    <meta property="og:type" content="website">
  <meta data-intl-tel-input-cdn-path="intlTelInput/"></head>
  <body data-path-to-root="./" data-include-products="false" class="u-body u-xl-mode" data-lang="en"><header class="u-clearfix u-header u-image u-shading u-header" id="sec-9641" data-animation-name="" data-animation-duration="0" data-animation-delay="0" data-animation-direction="" data-image-width="1500" data-image-height="1000"><div class="u-clearfix u-sheet u-sheet-1">
        <a href="./" data-page-id="30631203" class="u-image u-logo u-image-1" data-image-width="3303" data-image-height="4007" title="Home">
          <img src="images/mwleete.png" class="u-logo-image u-logo-image-1">
        </a>
        <nav class="u-menu u-menu-one-level u-menu-open-right u-offcanvas u-menu-1" data-responsive-from="SM">
          <div class="menu-collapse" style="font-size: 1rem; letter-spacing: 0px;">
            <a class="u-button-style u-custom-left-right-menu-spacing u-custom-padding-bottom u-custom-text-active-color u-custom-text-color u-custom-text-hover-color u-custom-text-shadow u-custom-top-bottom-menu-spacing u-hamburger-link u-nav-link u-text-active-palette-1-base u-text-hover-palette-2-base" href="#">
              <svg class="u-svg-link" viewBox="0 0 24 24"><use xlink:href="#menu-hamburger"></use></svg>
              <svg class="u-svg-content" version="1.1" id="menu-hamburger" viewBox="0 0 16 16" x="0px" y="0px" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns="http://www.w3.org/2000/svg"><g><rect y="1" width="16" height="2"></rect><rect y="7" width="16" height="2"></rect><rect y="13" width="16" height="2"></rect>
</g></svg>
            </a>
          </div>
          <div class="u-custom-menu u-nav-container">
            <ul class="u-nav u-unstyled u-nav-1"><li class="u-nav-item"><a class="u-button-style u-nav-link u-text-active-white u-text-body-alt-color u-text-hover-black" href="./" style="padding: 10px 20px;">Home</a>
</li><li class="u-nav-item"><a class="u-button-style u-nav-link u-text-active-white u-text-body-alt-color u-text-hover-black" href="./#block-1" data-page-id="30631203" style="padding: 10px 20px;">Portfolio</a>
</li><li class="u-nav-item"><a class="u-button-style u-nav-link u-text-active-white u-text-body-alt-color u-text-hover-black" href="./#sec-f979" data-page-id="30631203" style="padding: 10px 20px;">About Me</a>
</li></ul>
          </div>
          <div class="u-custom-menu u-nav-container-collapse">
            <div class="u-container-style u-grey-5 u-inner-container-layout u-opacity u-opacity-95 u-sidenav">
              <div class="u-inner-container-layout u-sidenav-overflow">
                <div class="u-menu-close"></div>
                <ul class="u-align-center u-nav u-popupmenu-items u-spacing-0 u-unstyled u-nav-2"><li class="u-nav-item"><a class="u-button-style u-nav-link" href="./">Home</a>
</li><li class="u-nav-item"><a class="u-button-style u-nav-link" href="./#block-1" data-page-id="30631203">Portfolio</a>
</li><li class="u-nav-item"><a class="u-button-style u-nav-link" href="./#sec-f979" data-page-id="30631203">About Me</a>
</li></ul>
              </div>
            </div>
            <div class="u-black u-menu-overlay u-opacity u-opacity-65"></div>
          </div>
        </nav>
      </div></header>
    <section class="u-clearfix u-section-1" id="sec-87c3">
      <div class="u-clearfix u-sheet u-sheet-1"></div>
    </section>
    <section class="u-clearfix u-image u-shading u-section-2" id="sec-039b" data-image-width="5000" data-image-height="2815">
      <div class="u-clearfix u-sheet u-sheet-1">
        <h2 class="u-text u-text-1"><span class="u-file-icon u-icon u-icon-1"><img src="images/6124990.png" alt=""></span>&nbsp;Scalable Data Pipeline for Spotify Analytics Using Apache Spark
        </h2>
        <p class="u-text u-text-2"> Automated ETL Pipeline for Spotify Data Using AWS, Apache Spark, and Snowflake</p>
        <p class="u-text u-text-3"> Designed and deployed a fully automated <span style="font-weight: 700;">ETL pipeline</span> that extracts complex JSON data from the<span style="font-weight: 700;"> Spotify API</span>, processes it using <span style="font-weight: 700;">PySpark on AWS Glue</span>, and loads it into <span style="font-weight: 700;">Snowflake</span> for analytics. Leveraging <span style="font-weight: 700;">AWS Lambda, S3, and Spark</span> optimizations, the pipeline ensures efficient data transformation, reducing processing time and enabling seamless visualization in Power BI.
        </p>
        <p class="u-align-left u-text u-text-4">
          <a class="u-active-none u-border-none u-btn u-button-link u-button-style u-hover-none u-none u-text-palette-1-base u-btn-1" href="https://github.com/Mudasir-Wazir/aws_spark_spotify_project" target="_blank">Read more Github. </a>
        </p>
      </div>
    </section>
    <section class="u-clearfix u-white u-section-3" id="sec-2bf3">
      <div class="u-clearfix u-sheet u-valign-bottom-xl u-valign-bottom-xs u-valign-middle-lg u-sheet-1">
        <h5 class="u-align-center u-text u-text-1">Key Business Values</h5>
        <div class="u-expanded-width-lg u-expanded-width-xl u-expanded-width-xs u-list u-list-1">
          <div class="u-repeater u-repeater-1">
            <div class="u-container-style u-list-item u-opacity u-opacity-75 u-repeater-item u-shape-rectangle u-list-item-1" data-animation-name="customAnimationIn" data-animation-duration="1500" data-animation-delay="250">
              <div class="u-container-layout u-similar-container u-container-layout-1"><span class="u-file-icon u-icon u-text-palette-1-base u-icon-1"><img src="images/5956361-d14455b9.png" alt=""></span>
                <h4 class="u-align-left u-text u-text-2"> Data-Driven Decision Making</h4>
                <ul class="u-align-left u-text u-text-3">
                  <li> Enables real-time analytics on Spotify data, helping businesses track trends and user engagement.</li>
                  <li> Provides structured, high-quality data in Snowflake, facilitating advanced insights and reporting in Power BI.</li>
                </ul>
              </div>
            </div>
            <div class="u-container-style u-list-item u-opacity u-opacity-75 u-repeater-item u-shape-rectangle u-list-item-2" data-animation-name="customAnimationIn" data-animation-duration="1500" data-animation-delay="250">
              <div class="u-container-layout u-similar-container u-container-layout-2"><span class="u-file-icon u-icon u-text-palette-1-base u-icon-2"><img src="images/4149646-a18bc05a.png" alt=""></span>
                <h4 class="u-align-left u-text u-text-4"> Operational Efficiency &amp; Cost Optimization</h4>
                <ul class="u-align-left u-text u-text-5">
                  <li> Automates the entire ETL process, reducing manual effort and minimizing operational overhead.</li>
                  <li> Optimized Spark jobs and partitioning techniques improve processing speed, cutting cloud compute costs.</li>
                </ul>
              </div>
            </div>
            <div class="u-container-style u-list-item u-opacity u-opacity-75 u-repeater-item u-shape-rectangle u-list-item-3" data-animation-name="customAnimationIn" data-animation-duration="1500" data-animation-delay="250">
              <div class="u-container-layout u-similar-container u-container-layout-3"><span class="u-file-icon u-icon u-text-palette-1-base u-icon-3"><img src="images/1673797-6a277427.png" alt=""></span>
                <h4 class="u-align-left u-text u-text-6"> Scalable &amp; Future-Ready Architecture</h4>
                <ul class="u-align-left u-text u-text-7">
                  <li> Built on AWS and Snowflake, ensuring easy scalability for growing data volumes.</li>
                  <li> Modular design allows integration with additional data sources and analytics tools as business needs evolve.<br>
                    <br>
                    <br>
                    <br>
                    <br>
                    <br>
                    <br>
                  </li>
                </ul>
              </div>
            </div>
          </div>
        </div>
      </div>
    </section>
    <section class="u-clearfix u-grey-5 u-section-4" id="sec-a9c9">
      <div class="u-clearfix u-sheet u-sheet-1">
        <p class="u-large-text u-text u-text-default u-text-variant u-text-1">Project Overview</p>
        <p class="u-text u-text-default u-text-2"> This project presents a sophisticated ETL pipeline architecture specifically designed to ingest, transform, and load Spotify playlist data into a Snowflake database for comprehensive analysis and visualization.&nbsp;<br>
          <br>The pipeline capitalizes on a synergistic integration of AWS services, Snowflake, and Power BI to automate the intricate processes of data handling. By leveraging Apache Spark within the transformation phase, the pipeline achieves an unparalleled capacity for handling large-scale data with efficiency and scalability.&nbsp;<br>
          <br>This methodological approach ensures high performance and adaptability to complex data structures, making it an exemplary model for data engineering workflows.
        </p>
        <img class="custom-expanded u-image u-image-contain u-image-default u-image-1" src="images/architecture.jpg" alt="" data-image-width="2884" data-image-height="1626">
        <p class="u-text u-text-3">Tools Used :</p>
        <ul class="u-text u-text-4">
          <li><span style="font-size: 0.857143rem; background-color: #f2f2f2; color: #111111; font-family: 'Open Sans',sans-serif;">Spotify API</span>
          </li>
          <li><span style="font-size: 0.857143rem;">AWS Lambda</span>
          </li>
          <li><span style="font-size: 0.857143rem;">Amazon CloudWatch</span>
          </li>
          <li><span style="font-size: 0.857143rem;">Amazon S3</span>
          </li>
          <li><span style="font-size: 0.857143rem;">AWS Glue</span>
          </li>
          <li><span style="font-size: 0.857143rem;">PySpark</span>
          </li>
          <li><span style="font-size: 0.857143rem;">Snowflake</span>
          </li>
          <li><span style="font-size: 0.857143rem;">Snowpipe</span>
          </li>
          <li><span style="font-size: 0.857143rem;">SQL</span>
          </li>
          <li><span style="font-size: 0.857143rem;">Power BI</span>
          </li>
          <li><span style="font-size: 0.857143rem;">Python</span>
          </li>
          <li><span style="font-size: 0.857143rem;">JSON</span>
          </li>
          <li><span style="font-size: 0.857143rem;">CSV</span>
          </li>
          <li><span style="font-size: 0.857143rem;">AWS IAM Roles</span>
          </li>
          <li><span style="font-size: 0.857143rem;">AWS Storage Integration</span>
          </li>
        </ul>
      </div>
    </section>
    <section class="u-clearfix u-section-5" id="sec-a09e">
      <div class="u-clearfix u-sheet u-sheet-1">
        <p class="u-large-text u-text u-text-default u-text-variant u-text-1">Key Features </p>
        <ul class="u-text u-text-default u-text-2">
          <li>Automation: Entire pipeline (ETL) is automated with triggers from CloudWatch and Snowpipe.&nbsp;</li>
          <li>Scalability: Using AWS Lambda, Glue, and Spark allows handling large volumes of Spotify data efficiently.&nbsp;</li>
          <li>Real-time Data Updates: Snowpipe enables near-real-time updates of data in Snowflake.&nbsp;</li>
          <li>Customizable Transformations: Transformation logic is adaptable to different data structures or additional requirements with Spark providing the flexibility to process complex and nested data efficiently.</li>
        </ul>
      </div>
    </section>
    <section class="u-clearfix u-grey-5 u-section-6" id="sec-beab">
      <div class="u-clearfix u-sheet u-sheet-1">
        <p class="u-large-text u-text u-text-default u-text-variant u-text-1">1. Data Extraction: AWS Lambda</p>
        <p class="u-text u-text-default u-text-2">A Spotify API is used to extract raw playlist data in JSON format. The connection is established using SpotifyClientCredentials, where client credentials (Client ID and Secret) are securely stored in the Lambda environment variables.&nbsp;<br>
          <br>
        </p>
        <p class="u-text u-text-default u-text-3">Key Features of lambda_extraction_function.py:</p>
        <ul class="u-text u-text-default u-text-4">
          <li>Retrieves playlist details using the Spotify API.</li>
          <li>Saves the raw JSON data into an Amazon S3 bucket.</li>
          <li>Triggers an AWS Glue Job to process the extracted data.</li>
          <li>This function is triggered every midnight using Amazon CloudWatch.</li>
        </ul>
        <img class="custom-expanded u-image u-image-contain u-image-default u-image-1" src="images/extract_pipeline.png" alt="" data-image-width="1366" data-image-height="486">
      </div>
    </section>
    <section class="u-clearfix u-section-7" id="sec-63ec">
      <div class="u-clearfix u-sheet u-sheet-1">
        <p class="u-large-text u-text u-text-default u-text-variant u-text-1">2. Data Transformation: AWS Glue</p>
        <p class="u-text u-text-default u-text-2">The transformation process is implemented in the spark_transformation.py script using PySpark with Glue Context. Spark is a suitable choice for this transformation process due to its ability to handle large-scale data efficiently and perform distributed computing, which makes it ideal for processing and transforming extensive JSON data structures.</p>
        <p class="u-text u-text-default u-text-3">Steps Performed:</p>
        <ol class="u-text u-text-default u-text-4">
          <li>Raw Data Processing: The script processes the raw JSON data to extract details about albums, artists, and songs.&nbsp;</li>
          <li>Custom Functions: <span style="font-style: italic; font-weight: 700;">process_album:</span> Extracts album_id, album_name, release_date, total_tracks, and album_url. <span style="font-style: italic; font-weight: 700;">process_artists:</span> Extracts artist_id, artist_name, and artist_url. <span style="font-style: italic; font-weight: 700;">process_songs:</span> Extracts song_name, song_id, duration_ms, song_url, popularity, and links with corresponding albums and artists.&nbsp;
          </li>
          <li>Transformations:
Flattening nested JSON structures using explode, which simplifies the processing of complex JSON structures, making the transformation efficient and scalable.
Formatting the added_at field to a standard DATE format.&nbsp;</li>
          <li>Output: Transformed data is saved back into S3 under transformed_data/ in separate folders (album, artists, songs) as CSV files.</li>
        </ol>
      </div>
    </section>
    <section class="u-clearfix u-grey-5 u-section-8" id="sec-ae8f">
      <div class="u-clearfix u-sheet u-sheet-1">
        <p class="u-large-text u-text u-text-default u-text-variant u-text-1">3. Data Loading: Snowflake</p>
        <p class="u-text u-text-default u-text-2">A Snowflake SQL script (snowflake.sql) creates a database (spotify_db) with tables for albums (tbl_album), artists (tbl_artists), and songs (tbl_songs).</p>
        <p class="u-text u-text-default u-text-3">Snowpipe Integration:</p>
        <ol class="u-text u-text-default u-text-4">
          <li>An S3 bucket is integrated with Snowflake using Storage Integration (s3_init).&nbsp;</li>
          <li>A Snowpipe is configured to ingest transformed data automatically into the Snowflake tables.</li>
        </ol>
      </div>
    </section>
    <section class="u-clearfix u-section-9" id="block-1">
      <div class="u-clearfix u-sheet u-sheet-1">
        <p class="u-large-text u-text u-text-default u-text-variant u-text-1">4. Data Visualization: Power BI</p>
        <p class="u-text u-text-default u-text-2">The Snowflake tables are connected to Power BI, where detailed visualizations are created.</p>
        <ol class="u-text u-text-default u-text-3">
          <li>Top 10 artists by Song Popularity&nbsp;</li>
          <li>How song popularity trends monthly?&nbsp;</li>
          <li>Song duration vs Song Popularity</li>
        </ol>
        <p class="u-text u-text-default u-text-4">These visualizations provide valuable insights into Spotify data trends.</p>
        <img class="u-image u-image-default u-image-1" src="images/dashboard1.png" alt="" data-image-width="1480" data-image-height="803">
      </div>
    </section>
    
    
    
    <footer class="u-align-center-md u-align-center-sm u-align-center-xs u-clearfix u-footer u-grey-80" id="sec-2ef8"><div class="u-clearfix u-sheet u-sheet-1">
        <a href="#" class="u-image u-logo u-image-1" data-image-width="3303" data-image-height="4007">
          <img src="images/mwleete.png" class="u-logo-image u-logo-image-1">
        </a>
        <div class="u-align-left u-social-icons u-social-icons-1">
          <a class="u-social-url" title="linkedin" target="_blank" href="https://www.linkedin.com/in/mudasir-wazir/"><span class="u-icon u-social-icon u-social-linkedin u-icon-1"><svg class="u-svg-link" preserveAspectRatio="xMidYMin slice" viewBox="0 0 112 112" style=""><use xlink:href="#svg-ebfd"></use></svg><svg class="u-svg-content" viewBox="0 0 112 112" x="0" y="0" id="svg-ebfd"><circle fill="currentColor" cx="56.1" cy="56.1" r="55"></circle><path fill="#FFFFFF" d="M41.3,83.7H27.9V43.4h13.4V83.7z M34.6,37.9L34.6,37.9c-4.6,0-7.5-3.1-7.5-7c0-4,3-7,7.6-7s7.4,3,7.5,7
      C42.2,34.8,39.2,37.9,34.6,37.9z M89.6,83.7H76.2V62.2c0-5.4-1.9-9.1-6.8-9.1c-3.7,0-5.9,2.5-6.9,4.9c-0.4,0.9-0.4,2.1-0.4,3.3v22.5
      H48.7c0,0,0.2-36.5,0-40.3h13.4v5.7c1.8-2.7,5-6.7,12.1-6.7c8.8,0,15.4,5.8,15.4,18.1V83.7z"></path></svg></span>
          </a>
          <a class="u-social-url" title="github" target="_blank" href="https://github.com/Mudasir-Wazir"><span class="u-icon u-social-github u-social-icon u-icon-2"><svg class="u-svg-link" preserveAspectRatio="xMidYMin slice" viewBox="0 0 112 112" style=""><use xlink:href="#svg-e230"></use></svg><svg class="u-svg-content" viewBox="0 0 112 112" x="0" y="0" id="svg-e230"><circle fill="currentColor" cx="56.1" cy="56.1" r="55"></circle><path fill="#FFFFFF" d="M88,51.3c0-5.5-1.9-10.2-5.3-13.7c0.6-1.3,2.3-6.5-0.5-13.5c0,0-4.2-1.4-14,5.3c-4.1-1.1-8.4-1.7-12.7-1.8
	c-4.3,0-8.7,0.6-12.7,1.8c-9.7-6.6-14-5.3-14-5.3c-2.8,7-1,12.2-0.5,13.5C25,41.2,23,45.7,23,51.3c0,19.6,11.9,23.9,23.3,25.2
	c-1.5,1.3-2.8,3.5-3.2,6.8c-3,1.3-10.2,3.6-14.9-4.3c0,0-2.7-4.9-7.8-5.3c0,0-5-0.1-0.4,3.1c0,0,3.3,1.6,5.6,7.5c0,0,3,9.1,17.2,6
	c0,4.3,0.1,8.3,0.1,9.5h25.2c0-1.7,0.1-7.2,0.1-14c0-4.7-1.7-7.9-3.4-9.4C76,75.2,88,70.9,88,51.3z"></path></svg></span>
          </a>
          <a class="u-social-url" title="email" target="_blank" href="mailto:maddewazir10@gmail.com"><span class="u-icon u-social-email u-social-icon u-icon-3"><svg class="u-svg-link" preserveAspectRatio="xMidYMin slice" viewBox="0 0 112 112" style=""><use xlink:href="#svg-b44b"></use></svg><svg class="u-svg-content" viewBox="0 0 112 112" x="0" y="0" id="svg-b44b"><circle fill="currentColor" cx="56.1" cy="56.1" r="55"></circle><path id="path3864" fill="#FFFFFF" d="M27.2,28h57.6c4,0,7.2,3.2,7.2,7.2l0,0v42.7c0,3.9-3.2,7.2-7.2,7.2l0,0H27.2
	c-4,0-7.2-3.2-7.2-7.2V35.2C20,31.1,23.2,28,27.2,28 M56,52.9l28.8-17.8H27.2L56,52.9 M27.2,77.7h57.6V43.5L56,61.3L27.2,43.5V77.7z
	"></path></svg></span>
          </a>
        </div>
      </div></footer>
    <section class="u-backlink u-clearfix u-grey-80">
      <p class="u-text"><span>This site was created with the </span>
        <a class="u-link" href="https://nicepage.com/" target="_blank" rel="nofollow"><span>Nicepage</span>
        </a>
      </p>
    </section><span style="height: 64px; width: 64px; margin-left: 0px; margin-right: auto; margin-top: 0px; background-image: none; right: 20px; bottom: 20px; padding: 16px;" class="u-back-to-top u-grey-5 u-icon u-icon-rounded u-opacity u-opacity-85 u-text-black" data-href="#"><svg class="u-svg-link" preserveAspectRatio="xMidYMin slice" viewBox="0 0 551.13 551.13"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#svg-1d98"></use></svg><svg class="u-svg-content" enable-background="new 0 0 551.13 551.13" viewBox="0 0 551.13 551.13" xmlns="http://www.w3.org/2000/svg" id="svg-1d98"><path d="m275.565 189.451 223.897 223.897h51.668l-275.565-275.565-275.565 275.565h51.668z"></path></svg></span>
  
</body></html>